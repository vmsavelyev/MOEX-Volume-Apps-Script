По большому счету это микроскопический пет-проект для образовательных целей

В репозитории находится скрипт написанный для Google Apps Script

Данный скрипт по запуску в Google Apps Script должен заполнять табицу на Google Sheets в формате

| Тикер    | Признак строки | Средняя | Дата1 | Дата2 | ... |
|----------|----------------|---------|-------|-------|-----|
| Tiket_1  | Объем          | 1.2М    | 1.1М  | 1.3М  | ... |
| Tiket_1  | Дельта         | 5.2%    | 0%    | 8.1%  | ... |
| Tiket_1  | Изменение      | 2.1%    | 1.5%  | 2.7%  | ... |
| Tiket_2  | Объем          | 1.2М    | 3.1М  | 3.3М  | ... |
| Tiket_2  | Дельта         | 5.2%    | 0%    | 8.1%  | ... |
| Tiket_2  | Изменение      | 2.1%    | 4.5%  | 4.7%  | ... |

Скрипт должен запускаться после первого запуска каждый день по тригеру и соирать данные за предыдущий торговый день ночью по МсК (в скрипте есть переменные связанные с временим закупка)


=====

Чуть подробнее

Давайте посмотрим на текущий код скрипта, чтобы понять, какие данные он собирает с Московской биржи:


[1 tool called]

## **Данные, которые собирает скрипт с Московской биржи (MOEX):**

### **1. Объемы торгов (VALUE)**
- **Источник:** API MOEX `https://iss.moex.com/iss/history/engines/stock/markets/shares/boards/TQBR/securities/{TICKER}.json`
- **Поле:** `VALUE` - общий объем торгов в рублях
- **Формат:** Числовые значения с форматированием `#,##0.00[$ ₽]`

### **2. Изменение цены в процентах (TRENDCLSPR)**
- **Источник:** Тот же API MOEX
- **Поле:** `TRENDCLSPR` - изменение цены закрытия в процентах
- **Формат:** Процентные значения (делится на 100 для корректного отображения)
- **Визуализация:** Форматируется как `0.00%`

### **3. Дельты объемов**
- **Источник:** Вычисляется локально на основе данных об объемах
- **Расчет:** `((текущий_объем - предыдущий_объем) / предыдущий_объем) * 100%`
- **Формат:** Процентные значения `0.00%`

### **4. Дополнительные данные:**
- **Даты торгов:** `TRADEDATE` - даты торговых сессий
- **Тикеры:** Список акций для анализа (SBER, LQDT и др.)
- **Производственный календарь:** Выходные и праздничные дни через API `isdayoff.ru`

### **5. Структура данных в таблице:**
```
| Тикер | Признак строки | Средняя | Дата1 | Дата2 | ... |
|-------|----------------|---------|-------|-------|-----|
| SBER  | Объем          | 1.2М    | 1.1М  | 1.3М  | ... |
| SBER  | Дельта         | 5.2%    | 0%    | 8.1%  | ... |
| SBER  | Изменение      | 2.1%    | 1.5%  | 2.7%  | ... |
```

### **6. Особенности сбора:**
- **Параллельные запросы:** До 100 тикеров одновременно через `UrlFetchApp.fetchAll()`
- **Проверка завершения дня:** Данные обновляются только после 23:55 МСК
- **Обработка выходных:** Автоматическое заполнение пропусков последними известными значениями
- **Цветовая индикация:** Выходные дни выделяются желтым цветом

Скрипт собирает **финансовые метрики** для анализа торговой активности акций на Московской бирже.